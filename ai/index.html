<!DOCTYPE html>
<html>
<head>
  <title>AI Model</title>
  <style>
    /* Style for chat-like interface */
    #chatContainer {
      display: flex;
      flex-direction: column;
    }
    #chatContainer textarea {
      width: 100%;
      margin-bottom: 10px;
      resize: none; /* Prevent resizing */
    }
  </style>
</head>
<body>
  <h1 id="modelTitle">Google Gemini Model</h1>
  <form id="form">
    <input type="text" id="system" name="system" placeholder="You're helpful AI coder which specialize in JavaScript">

    <select id="model" name="model">
      <option value="GEMINI" selected>GEMINI</option>
      <option value="CHATGPT">CHATGPT</option>
    </select>

    <div id="chatContainer">
      <textarea id="prompt" name="prompt" rows="5" placeholder="Enter your prompt here"></textarea>
      <textarea id="response" name="response" placeholder="Response"></textarea>
    </div>
  
    <input type="submit" value="Submit">
  </form>

  <script>
    var version = " 0.0.5";
    // Adding version to the end of h1
    document.getElementById("modelTitle").innerText += version;

    // Function to generate response
    function generateResponse(prompt, model) {
      if (model === "GEMINI") {
        GEMINI(prompt);
      } else if (model === "CHATGPT") {
        document.getElementById('modelTitle').innerText = "OpenAI ChatGPT Model";
        // Add code to use OpenAI ChatGPT model
      }
    }

    // Submit form when Ctrl+Enter is pressed in prompt textarea
    document.getElementById("prompt").addEventListener("keydown", function(event) {
      if (event.ctrlKey && event.key === "Enter") {
        event.preventDefault();
        var prompt = document.getElementById('prompt').value;
        var model = document.getElementById('model').value;
        generateResponse(prompt, model);
      }
    });

    // Submit form on submit button click
    document.getElementById("form").addEventListener("submit", function(event) {
      event.preventDefault();
      var prompt = document.getElementById('prompt').value;
      var model = document.getElementById('model').value;
      generateResponse(prompt, model);
    });

    function GEMINI(prompt) {
      var apiKey = "AIzaSyCf4gfFzHbnFqivbgZTNpK7pmnRIgjSxjk";
      var apiUrl = "https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent";

      var headers = {
        "Content-Type": "application/json"
      };
    
      var requestBody = {
        "contents": [{
          "parts": [{
            "text": prompt
          }]}
        ]
      };
    
      var options = {
        "method": "POST",
        "headers": headers,
        "body": JSON.stringify(requestBody)
      };
    
      fetch(apiUrl + "?key=" + apiKey, options)
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.json();
        })
        .then(data => {
          console.log('API Response:', data);
          if (data && data.candidates && data.candidates.length > 0) {
            // Assuming the first candidate contains the desired content
            var content = data.candidates[0].content;
            if (content && content.parts && content.parts.length > 0) {
              var output = content.parts[0].text;
              document.getElementById('response').value = output;
              adjustTextareaHeight('response');
              addNewPromptAndResponseTextarea();
            } else {
              throw new Error('No content found in API response');
            }
          } else {
            throw new Error('No candidates found in API response');
          }
        })
        .catch(error => {
          console.error('Error:', error);
          document.getElementById('response').value = 'Error: ' + error.message;
          adjustTextareaHeight('response');
          addNewPromptAndResponseTextarea();
        });
    }

    // Function to adjust textarea height based on content
    function adjustTextareaHeight(textareaId) {
      var textarea = document.getElementById(textareaId);
      textarea.style.height = 'auto';
      textarea.style.height = (textarea.scrollHeight) + 'px';
    }

    // Function to add new prompt and response textarea below the response
    function addNewPromptAndResponseTextarea() {
      var chatContainer = document.getElementById('chatContainer');
      
      // Create new prompt textarea
      var newPromptTextarea = document.createElement('textarea');
      newPromptTextarea.setAttribute('id', 'prompt');
      newPromptTextarea.setAttribute('name', 'prompt');
      newPromptTextarea.setAttribute('rows', '5');
      newPromptTextarea.setAttribute('placeholder', 'Enter your prompt here');
      chatContainer.appendChild(newPromptTextarea);
      
      // Create new response textarea
      var newResponseTextarea = document.createElement('textarea');
      newResponseTextarea.setAttribute('id', 'response');
      newResponseTextarea.setAttribute('name', 'response');
      newResponseTextarea.setAttribute('placeholder', 'Response');
      chatContainer.appendChild(newResponseTextarea);
      
      // Focus on the new prompt textarea
      document.getElementById('prompt').focus();
    }
  </script>
</body>
</html>
