<!DOCTYPE html>
<html>
<head>
    <title>Google Sheets Parser</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>
    <input type="text" id="sheetUrl" placeholder="Public Google Sheet URL">
    <input type="text" id="sheetName" placeholder="Sheet Name">
    <button onclick="parseSheet()">Get</button>
    <p id="loading" style="display: none;">Loading...</p>
    <select id="columnTitle" style="display: none;"></select>

    <script>
        function parseSheet() {
            document.getElementById('loading').style.display = 'block';
            var url = document.getElementById('sheetUrl').value;
            var sheetName = document.getElementById('sheetName').value;
            var sheetId = url.split('/')[5];
            var gid = url.split('gid=')[1];
            var sheetUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:csv&sheet=${sheetName}`;

            $.get(sheetUrl, function(data) {
                var lines = data.split("\n");
                var columnTitles = lines[0].split(",");

                var select = document.getElementById('columnTitle');
                select.innerHTML = "";
                select.style.display = "block";

                for(var j = 0; j < columnTitles.length; j++) {
                    var option = document.createElement('option');
                    option.text = columnTitles[j];
                    select.add(option);
                }
                document.getElementById('loading').style.display = 'none';
            }).fail(function() {
                alert('Failed to fetch data. Please check the URL and Sheet Name.');
                document.getElementById('loading').style.display = 'none';
            });
        }
    </script>
</body>
</html>