<!DOCTYPE html>
<html>
<head>
    <title>Google Sheets Parser</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>
    <input type="text" id="sheetUrl" placeholder="Public Google Sheet URL">
    <input type="text" id="sheetName" placeholder="Sheet Name">
    <button onclick="parseSheet()">Get</button>
    <p id="loading" style="display: none;">Loading...</p>
    <select id="outputColumn" style="display: none;"></select>
    <select id="promptColumn" style="display: none;"></select>
    <button id="showContent" style="display: none;" onclick="showContent()">ðŸ‘€ Content</button>
    <textarea id="outputContent" style="display: none;"></textarea>
    <textarea id="promptContent" style="display: none;"></textarea>

    <script>
        var lines = [];
        function parseSheet() {
            var url = document.getElementById('sheetUrl').value;
            var sheetName = document.getElementById('sheetName').value;
            var urlRegex = /^https:\/\/docs\.google\.com\/spreadsheets\/d\/(.+)\/edit#gid=(.+)$/;

            if (!urlRegex.test(url)) {
                alert('Invalid URL. The correct format is: https://docs.google.com/spreadsheets/d/{sheetId}/edit#gid={gid}');
                return;
            }

            document.getElementById('loading').style.display = 'block';
            var sheetId = url.split('/')[5];
            var gid = url.split('gid=')[1];
            var sheetUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:csv&sheet=${sheetName}`;

            $.get(sheetUrl, function(data) {
                lines = data.split("\n");
                var columnTitles = lines[0].split(",");

                var outputSelect = document.getElementById('outputColumn');
                var promptSelect = document.getElementById('promptColumn');
                outputSelect.innerHTML = "";
                promptSelect.innerHTML = "";
                outputSelect.style.display = "block";
                promptSelect.style.display = "block";
                document.getElementById('showContent').style.display = "block";

                for(var j = 0; j < columnTitles.length; j++) {
                    var option1 = document.createElement('option');
                    var option2 = document.createElement('option');
                    option1.text = columnTitles[j];
                    option2.text = columnTitles[j];
                    outputSelect.add(option1);
                    promptSelect.add(option2);
                }
                document.getElementById('loading').style.display = 'none';
            }).fail(function() {
                alert('Failed to fetch data. Please check the URL and Sheet Name.');
                document.getElementById('loading').style.display = 'none';
            });
        }

        function showContent() {
            var outputIndex = document.getElementById('outputColumn').selectedIndex;
            var promptIndex = document.getElementById('promptColumn').selectedIndex;
            var outputContent = "";
            var promptContent = "";

            for(var i = 1; i < lines.length; i++) {
                var cells = lines[i].split(",");
                outputContent += cells[outputIndex] + "\n";
                promptContent += cells[promptIndex] + "\n";
            }

            document.getElementById('outputContent').style.display = "block";
            document.getElementById('promptContent').style.display = "block";
            document.getElementById('outputContent').value = outputContent;
            document.getElementById('promptContent').value = promptContent;
        }
    </script>
</body>
</html>