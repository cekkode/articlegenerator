<!DOCTYPE html>
<html>
<head>
  <style>
    #app, #app1, #app2 {
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 10px;
      width: 100%;
    }

    #app > div, #app1 > div, #app2 > div {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      width: 100%;
    }

    textarea, input[type="text"] {
      width: 32%;
    }

    textarea {
      height: 200px;
    }

    .modifier-container {
      display: flex;
      flex-direction: column;
      width: 32%;
    }
    .modifier-container > textarea, .modifier-container > input[type="text"] {
      width: 100%;
    }

    .textarea-container {
      position: relative;
    }

    .clear-btn, .copy-btn {
      position: absolute;
      top: 5px;
      right: 5px;
      background: none;
      border: none;
      cursor: pointer;
    }

  </style>
</head>
<body>
  <script>
    // Add autosuggest in placeholder
    document.addEventListener('DOMContentLoaded', function() {
      const keywordsInput = document.getElementById('keywords');
      if (keywordsInput.value) {
        keywordsInput.dispatchEvent(new Event('input'));
      }
    });
    
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('keywords').addEventListener('keyup', function(e) {
        const regex = /\[(.*?)\]/g;
        let match;
        let placeholders = [];
        while ((match = regex.exec(e.target.value)) != null) {
          placeholders.push(match[0]);
        }
        placeholders = [...new Set(placeholders)]; // remove duplicates
        document.getElementById('placeholder1').setAttribute('list', 'suggestions');
        document.getElementById('placeholder2').setAttribute('list', 'suggestions');
        let datalist = document.getElementById('suggestions');
        if (!datalist) {
          datalist = document.createElement('datalist');
          datalist.id = 'suggestions';
          document.body.appendChild(datalist);
        }
        datalist.innerHTML = '';
        placeholders.forEach(function(placeholder) {
          const option = document.createElement('option');
          option.value = placeholder;
          datalist.appendChild(option);
        });
      });
    });
    
    // Force placeholder to be upper case
    document.getElementById('placeholder1').addEventListener('input', function(e) {
      e.target.value = e.target.value.toUpperCase();
    });
    
    document.getElementById('placeholder2').addEventListener('input', function(e) {
      e.target.value = e.target.value.toUpperCase();
    });
    
    // Save data to local storage
    window.onload = function() {
      var inputs = document.getElementsByTagName('input');
      var textareas = document.getElementsByTagName('textarea');

      for(var i = 0; i < inputs.length; i++) {
        if(inputs[i].type.toLowerCase() == 'text' || inputs[i].type.toLowerCase() == 'number') {
          inputs[i].value = localStorage.getItem(inputs[i].id);
          inputs[i].addEventListener('change', function() {
            localStorage.setItem(this.id, this.value);
          });
        }
      }

      for(var i = 0; i < textareas.length; i++) {
        textareas[i].value = localStorage.getItem(textareas[i].id);
        textareas[i].addEventListener('change', function() {
          localStorage.setItem(this.id, this.value);
        });
      }
    }
    
    // Copy to clipboard
    function copyToClipboard() {
      var copyText = document.getElementById("results");
      copyText.select();
      copyText.setSelectionRange(0, 99999);
      document.execCommand("copy");
    }
    
    // Clear text area
    function clearTextArea() {
      document.getElementById('keywords').value = '';
      localStorage.removeItem('keywords');
    }
    
    // Multiply keyword generator
        function generate() {
      var keywords = document.getElementById('keywords').value.split('\n');
      var modifier1 = document.getElementById('modifier1').value.split('\n');
      var modifier2 = document.getElementById('modifier2').value.split('\n');
      var placeholder1 = document.getElementById('placeholder1').value;
      var placeholder2 = document.getElementById('placeholder2').value;
      var addSpace = document.getElementById('addSpace').checked;
      var results = [];
    
      keywords.forEach(function(keyword) {
        var result = keyword;
        var placeholder1Exists = placeholder1 && keyword.includes(placeholder1);
        var placeholder2Exists = placeholder2 && keyword.includes(placeholder2);
    
        if (placeholder1Exists || placeholder2Exists) {
          modifier1.forEach(function(mod1) {
            if (placeholder1Exists) {
              result = result.replace(placeholder1, mod1);
            }
            modifier2.forEach(function(mod2) {
              if (placeholder2Exists) {
                result = result.replace(placeholder2, mod2);
              }
              results.push(result);
            });
          });
        } else {
          results.push(result);
        }
      });
    
      document.getElementById('results').value = results.join('\n');
    }
    
    // Auto count dripfeed
let results = document.getElementById('results');
let dripfeed = document.getElementById('dripfeed');
let generateBtn = document.getElementById('generateBtn');

function calculateDripfeed() {
  let resultsLength = results.value.split('\n').length;
  dripfeed.value = Math.ceil(resultsLength / 30);
}

// Recalculate when 'results' changes
results.addEventListener('input', calculateDripfeed);

// Recalculate when 'generate' button is clicked
generateBtn.addEventListener('click', calculateDripfeed);
    
    let lastSubmittedUrls = '';

    function isValidUrls(urls) {
      var urlArray = urls.split('\n');
      var urlRegex = /^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/;

      for (var i = 0; i < urlArray.length; i++) {
        if (!urlRegex.test(urlArray[i])) {
          return false;
        }
      }

      return true;
    }

// Send results to Omega Indexer
async function sendToOmega() {
  var apiKey = document.getElementById('omegaApiKey').value;
  var campaignName = encodeURIComponent(document.getElementById('campaignName').value);
  var urls = document.getElementById('results').value;
  var dripfeed = document.getElementById('dripfeed').value;

  if (!isValidUrls(urls)) {
    alert("Please enter valid URLs");
    return;
  }

  if (urls === lastSubmittedUrls) {
    alert("You've already submitted these URLs");
    return;
  }

  lastSubmittedUrls = urls;
  urls = encodeURIComponent(urls.split('\n').join('|'));

  try {
    const response = await fetch('https://www.omegaindexer.com/amember/dashboard/api', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      },
      body: `apikey=${apiKey}&campaignname=${campaignName}&dripfeed=${dripfeed}&urls=${urls}`
    });

    if (response.ok) {
      alert("Data sent to Omega Indexer successfully");
    } else {
      alert("Error sending data to Omega Indexer");
    }
  } catch (error) {
    console.error('Error:', error);
  }
}

// Clear all data button
function clearAllData() {
  localStorage.clear();
  var inputs = document.getElementsByTagName('input');
  var textareas = document.getElementsByTagName('textarea');

  for(var i = 0; i < inputs.length; i++) {
    if(inputs[i].type.toLowerCase() == 'text' || inputs[i].type.toLowerCase() == 'number') {
      inputs[i].value = '';
    }
  }

  for(var i = 0; i < textareas.length; i++) {
    textareas[i].value = '';
  }
}
  </script>

<div id="app1">
  <div class="textarea-container modifier-container">
    <textarea id="keywords" placeholder="keywords"></textarea>
    <button class="clear-btn" onclick="clearTextArea()">üóëÔ∏è</button>
  </div>
    <div class="modifier-container">
      <input type="text" id="placeholder1" placeholder="placeholder 1">
      <textarea id="modifier1" placeholder="modifier 1"></textarea>
    </div>
    <div class="modifier-container">
      <input type="text" id="placeholder2" placeholder="placeholder 2">
      <textarea id="modifier2" placeholder="modifier 2"></textarea>
    </div>
  </div>
  <div>
    <input type="checkbox" id="addSpace"> Add Space
    <button onclick="clearAllData()">üîÑ</button>
  </div>
</div>
<div id="app2">
  <div class="textarea-container modifier-container">
    <textarea id="results" placeholder="results" readonly></textarea>
    <button class="copy-btn" onclick="copyToClipboard()">üìã</button>
    <button id="generateBtn" onclick="generate()">Generate</button>
  </div>
  <div class="textarea-container modifier-container">
    <input type="text" id="omegaApiKey" placeholder="Omega API Key">
    <input type="text" id="campaignName" placeholder="Campaign Name">
    <input type="number" id="dripfeed" placeholder="Dripfeed">
    <button onclick="sendToOmega()">Send to Omega</button>
  </div>    
</div>

  
</body>
</html>
